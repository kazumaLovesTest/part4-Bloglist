(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{45:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(18),s=n.n(c),u=n(3),o=n.n(u),i=n(1),l=n(6),b=n(5),d=n(0),j=function e(t){var n=t.blog,a=t.blogActions,c=Object(r.useState)(!1),s=Object(b.a)(c,2),u=s[0],o=s[1],i={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5,listStyle:"none"};return!1===u?Object(d.jsxs)("ul",{style:i,className:"Blog_When_hidden",children:[Object(d.jsxs)("li",{children:["Title:",n.title,Object(d.jsx)("button",{onClick:function(){return o(!u)},children:"View"}),Object(d.jsx)("button",{onClick:function(){return a.deleteBlog(n)},children:"delete"})]}),Object(d.jsxs)("li",{children:["Author:",n.author]})]}):!0===u?Object(d.jsxs)("ul",{style:i,className:"Blog_When_Viewed",children:[Object(d.jsxs)("li",{children:["Title:",n.title,Object(d.jsx)("button",{onClick:function(){return o(!u)},children:"Hide"}),Object(d.jsx)("button",{onClick:function(){return a.deleteBlog(e)},children:"delete"})]}),Object(d.jsxs)("li",{children:["Author:",n.author]}),Object(d.jsxs)("li",{children:["Link:",n.url]}),Object(d.jsxs)("li",{children:["Likes:",n.likes,Object(d.jsx)("button",{onClick:function(){return a.addLike(n)},children:"Like"})]}),Object(d.jsxs)("li",{children:["Id:",n.id]})]}):void 0},p=function(e){var t=e.handleAdding,n=Object(r.useState)(""),a=Object(b.a)(n,2),c=a[0],s=a[1],u=Object(r.useState)(""),o=Object(b.a)(u,2),i=o[0],l=o[1],j=Object(r.useState)(""),p=Object(b.a)(j,2),O=p[0],f=p[1];return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("form",{onSubmit:function(e){(e.preventDefault(),""!==O&&""!==i&&""!==c)?(t({author:O,title:c,url:i}),s(""),l(""),f("")):alert("You must fill all blanks")},children:["Author:",Object(d.jsx)("input",{id:"author",type:"text",name:"author",value:O,onChange:function(e){var t=e.target;return f(t.value)}}),Object(d.jsx)("br",{}),"Title:",Object(d.jsx)("input",{id:"title",type:"text",name:"title",value:c,onChange:function(e){var t=e.target;return s(t.value)}}),Object(d.jsx)("br",{}),"URL:",Object(d.jsx)("input",{id:"url",type:"url",name:"url",value:i,onChange:function(e){var t=e.target;return l(t.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{id:"submit",type:"submit",children:"Add blog"})]})})},O=n(8),f=n.n(O),g=function e(t){var n=t.login,r=t.setUsername,a=t.setPassword;return e.prototype={login:f.a.object.isRequired,setUsername:f.a.func.isRequired,setPassword:f.a.func.isRequired},Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("form",{onSubmit:n.handleLogin,children:["username:",Object(d.jsx)("input",{id:"username",type:"text",name:"username",value:n.username,onChange:function(e){var t=e.target;return r(t.value)}}),Object(d.jsx)("br",{}),"password:",Object(d.jsx)("input",{id:"password",type:"password",name:"password",value:n.password,onChange:function(e){var t=e.target;return a(t.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{type:"sumbit",children:"login"})]})})},h=function(e){var t=e.notification;if(null===t.errorMessage&&null===t.succuses)return Object(d.jsx)(d.Fragment,{});var n=t.errorMessage,r={border:"5px solid red",borderRadius:"14px",fontSize:"20px",padding:"20px",textAlign:"center"};return null===t.errorMessage&&(r.border="5px solid green",n=t.succuses),Object(d.jsx)("p",{style:r,className:"notification",children:n})},x=a.a.forwardRef((function(e,t){x.displayName="togglable";var n=Object(r.useState)(!1),a=Object(b.a)(n,2),c=a[0],s=a[1],u={display:c?"":"none"},o={display:c?"none":""},i=function(){s(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{style:o,children:Object(d.jsx)("button",{onClick:i,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:u,children:[e.children,Object(d.jsx)("button",{onClick:i,children:"cancel"})]})]})})),v=x,m=n(7),k=n.n(m),w="/api/blogs",y=null,S={getAll:function(){return k.a.get(w).then((function(e){return e.data}))},addBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},e.next=3,k.a.post(w,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){y="bearer ".concat(e)},updateBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},r="".concat(w,"/").concat(t.id),e.next=4,k.a.put(r,t,n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:y}},r="".concat(w,"/").concat(t.id),e.next=4,k.a.delete(r,n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},A={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},B=function(){var e=Object(r.useState)([]),t=Object(b.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),s=Object(b.a)(c,2),u=s[0],O=s[1],f=Object(r.useState)(""),x=Object(b.a)(f,2),m=x[0],k=x[1],w=Object(r.useState)(null),y=Object(b.a)(w,2),B=y[0],M=y[1],T=Object(r.useState)({errorMessage:null,succuses:null}),C=Object(b.a)(T,2),L=C[0],R=C[1],U=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==u&&""!==m){e.next=5;break}return R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:"Give both username and password"})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:null}))}),3e3),e.abrupt("return");case 5:return n={username:u,password:m},e.prev=6,e.next=9,A.login(n);case 9:r=e.sent,window.localStorage.setItem("loggedBloglistAppUser",JSON.stringify(r)),S.setToken(r.token),M(r),O(""),k(""),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:"wrong username or password"})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:null}))}),3e3);case 20:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(l.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.addBlog(t);case 3:r=e.sent,a(n.concat(r)),R(Object(i.a)(Object(i.a)({},L),{},{succuses:"".concat(r.title," was added")})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{succuses:null}))}),3e3),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:"couldnt add blog because ".concat(e.t0)})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:null}))}),3e3);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(o.a.mark((function e(t){var r,c,s,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(i.a)(Object(i.a)({},t),{},{likes:t.likes+1,user:B._id}),e.prev=1,e.next=4,S.updateBlog(r);case 4:c=e.sent,s=n.map((function(e){return e.id===c.id?c:e})),u=s.sort((function(e,t){return e.likes<t.likes?1:e.likes>t.likes?-1:0})),a(u),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:"couldnt add like because ".concat(e.t0)})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:null}))}),3e3);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(l.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==window.confirm("Are you sure you want to delete this blog?")){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,S.deleteBlog(t);case 5:r=n.filter((function(e){return e.id!==t.id})),a(r),R(Object(i.a)(Object(i.a)({},L),{},{succuses:"".concat(t.title," was deleted")})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{succuses:null}))}),3e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:"couldnt delete blog because ".concat(e.t0)})),setTimeout((function(){R(Object(i.a)(Object(i.a)({},L),{},{errorMessage:null}))}),3e3);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),_={username:u,password:m,handleLogin:U};Object(r.useEffect)((function(){S.getAll().then((function(e){var t=e.sort((function(e,t){return e.likes<t.likes?1:e.likes>t.likes?-1:0}));a(t)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBloglistAppUser");if(e){var t=JSON.parse(e);S.setToken(t.token),M(t)}}),[]);var z=Object(r.useRef)(),J={addLike:N,deleteBlog:F};return null===B?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(g,{login:_,setUsername:O,setPassword:k}),Object(d.jsx)(h,{notification:L})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"blogs"}),n.map((function(e){return Object(d.jsx)(j,{blog:e,blogActions:J},e.id)})),Object(d.jsx)("br",{}),B.username," Logged in ",Object(d.jsx)("button",{onClick:function(){window.localStorage.removeItem("loggedBloglistAppUser"),M(null)},children:"Log Out"}),Object(d.jsx)(v,{buttonLabel:"add blog",ref:z,children:Object(d.jsx)(p,{handleAdding:I})}),Object(d.jsx)(h,{notification:L})]})};s.a.render(Object(d.jsx)(B,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.b84e20e9.chunk.js.map